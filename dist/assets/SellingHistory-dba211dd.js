import{_ as f,C as k,T as M,A as y,E as v,D as C,r as g,o as n,c as d,F as _,g as p,a as e,t as s,G as I,B as i,w as a,i as c}from"./index-2123eb2d.js";const O="/pharmacy/img/eye.png",T={components:{TheModal:k,TheButton:M},data:()=>({history:[],gettingHistory:!0,deleting:!1,deleteModal:!1,detailsModal:!1,selectedHistoryIndex:-1}),computed:{selectedOrderHistory(){return this.history[this.selectedHistoryIndex]||{cartItems:{}}},totalPrice(){let t=0;for(let o in this.selectedOrderHistory.cartItems)t+=this.selectedOrderHistory.cartItems[o].price*this.selectedOrderHistory.cartItems[o].quantity;return t}},methods:{getHistory(){this.gettingHistory=!0,y.getHistory().then(t=>{this.history=t.data}).catch(t=>{}).finally(()=>{this.gettingHistory=!1})},deleteHistory(){this.deleting=!0,y.deleteHistory(this.selectedOrderHistory._id).then(t=>{v(t),this.deleteModal=!1,this.getHistory()}).catch(t=>{C(t)}).finally(()=>{this.deleting=!1})}},mounted(){setTimeout(this.getHistory,333)}},V=e("h2",null,"SellingHistory",-1),w={key:0,class:"text-center"},B={key:1,class:"mt-4"},b=e("tr",null,[e("th",null,"Order Id"),e("th",null,"Customer Name"),e("th",null,"Customer Phone"),e("th",null,"Total Items"),e("th",null,"Action")],-1),N=["onClick"],P=["onClick"],S={class:"d-flex jc-between"},D=e("strong",null,"Customer: ",-1),q=e("strong",null,"Phone:",-1),A=e("h3",{class:"mt-4 mb-2"},"Cart Items",-1),E={class:"mt-2"},j=e("tr",null,[e("th",null,"Item"),e("th",null,"Weight"),e("th",null,"Price"),e("th",null,"Qty"),e("th",{class:"text-right"},"Total")],-1),x={class:"text-right"},F={colspan:"6"},G={class:"text-right"},L=e("hr",null,null,-1),U={class:"mt-3"};function z(t,o,Q,W,Y,r){const u=g("TheModal"),h=g("TheButton");return n(),d("div",null,[V,t.gettingHistory?(n(),d("div",w,"Loading...")):(n(),d("table",B,[b,(n(!0),d(_,null,p(t.history,(l,m)=>(n(),d("tr",{key:l._id},[e("td",null,s(l._id),1),e("td",null,s(l.customer),1),e("td",null,s(l.phone),1),e("td",null,s(Object.keys(l.cartItems).length),1),e("td",null,[e("img",{src:O,class:"action-icon action-icon--delete ml-3",alt:"",onClick:H=>{t.selectedHistoryIndex=m,t.detailsModal=!0}},null,8,N),e("img",{src:I,class:"action-icon action-icon--delete ml-3",alt:"",onClick:H=>{t.selectedHistoryIndex=m,t.deleteModal=!0}},null,8,P)])]))),128))])),i(u,{modelValue:t.detailsModal,"onUpdate:modelValue":o[0]||(o[0]=l=>t.detailsModal=l),heading:"Order Details",size:"lg"},{default:a(()=>[e("div",S,[e("div",null,[D,c(s(r.selectedOrderHistory.customer),1)]),e("div",null,[q,c(" "+s(r.selectedOrderHistory.phone),1)])]),A,e("div",E,[e("table",null,[j,(n(!0),d(_,null,p(r.selectedOrderHistory.cartItems,l=>(n(),d("tr",{key:l.name},[e("td",null,s(l.name),1),e("td",null,s(l.weight),1),e("td",null,s(l.price),1),e("td",null,s(l.quantity),1),e("td",x,s(l.quantity*l.price),1)]))),128)),e("tr",null,[e("td",F,[e("div",G,[L,e("strong",null,"Grand Total : "+s(r.totalPrice),1)])])])])])]),_:1},8,["modelValue"]),i(u,{modelValue:t.deleteModal,"onUpdate:modelValue":o[2]||(o[2]=l=>t.deleteModal=l),heading:"Are you sure?"},{default:a(()=>[e("p",null,'Do you really want to delete "'+s(r.selectedOrderHistory.customer)+'"?',1),e("div",U,[i(h,{onClick:r.deleteHistory,loading:t.deleting},{default:a(()=>[c("Yes")]),_:1},8,["onClick","loading"]),i(h,{color:"gray",class:"ml-4",onClick:o[1]||(o[1]=l=>t.deleteModal=!1)},{default:a(()=>[c(" No ")]),_:1})])]),_:1},8,["modelValue"])])}const J=f(T,[["render",z]]);export{J as default};
